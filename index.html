<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>Kishor Computer Invoice App v2</title>
  <style>
    body { font-family: 'Siyam Rupali', sans-serif; max-width: 900px; margin: auto; background: #f9f9f9; padding: 20px; }
    h2, h4 { text-align: center; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; background: #fff; margin-top: 20px; }
    th, td { border: 1px solid #000; padding: 8px; text-align: center; }
    input[type="text"], input[type="number"], input[type="date"] { width: 100%; padding: 5px; box-sizing: border-box; }
    .buttons { margin-top: 15px; text-align: center; }
    .signatures div { float: left; width: 50%; text-align: center; margin-top: 50px; }
    .invoice-box { background: white; padding: 20px; box-shadow: 0 0 10px #ccc; }
    #logoPreview { max-height: 80px; margin-bottom: 10px; display: block; margin-left: auto; margin-right: auto; }
    #qrCode { margin-top: 10px; }
    @media print {
      body { background: white; }
      .no-print { display: none; }
    }
  </style>
</head>
<body>
  <div class="invoice-box">
    <img id="logoPreview" src="" alt="Logo" />
    <h2>Kishor Computer</h2>
    <h4>‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡ßá‡¶¨‡¶æ, ‡¶´‡¶ü‡ßã‡¶ï‡¶™‡¶ø, ‡¶Æ‡ßá‡¶á‡¶≤, ‡¶ï‡¶Æ‡ßç‡¶™‡ßã‡¶ú, ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶®‡ßá‡¶ü‡¶ø‡¶Ç</h4>
    <p style="text-align:center;">
      Malironko Bazar, Louhajong, Munshiganj<br />
      Email: kishorcomputerbd@gmail.com
    </p>

    <div>
      <strong>Invoice ID:</strong> <span id="invoiceId"></span><br />
      <strong>Date:</strong> <input type="date" id="invoiceDate" />
    </div>

    <div style="margin-top:10px;">
      <strong>Customer Name:</strong> <input type="text" id="customerName" />
      <strong>Mobile:</strong> <input type="text" id="customerPhone" />
      <strong>Address:</strong> <input type="text" id="customerAddress" />
    </div>

    <table id="invoiceTable" aria-label="Invoice items">
      <thead>
        <tr>
          <th>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</th>
          <th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
          <th>‡¶¶‡¶∞ (‡ß≥)</th>
          <th>‡¶Æ‡ßã‡¶ü (‡ß≥)</th>
          <th class="no-print">‡¶Ö‡¶™‡¶∂‡¶®</th>
        </tr>
      </thead>
      <tbody id="itemsBody">
        <tr>
          <td><input type="text" placeholder="‡¶∏‡ßá‡¶¨‡¶æ/‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" /></td>
          <td><input type="number" value="1" min="0" onchange="calculateTotal()" /></td>
          <td><input type="number" value="0" min="0" onchange="calculateTotal()" /></td>
          <td class="totalCell">0.00</td>
          <td class="no-print"><button onclick="removeRow(this)">‚ùå</button></td>
        </tr>
      </tbody>
    </table>

    <button class="no-print" onclick="addRow()">+ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏/‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>

    <div class="buttons no-print">
      <button onclick="saveInvoice()">üíæ Save Invoice</button>
      <button onclick="downloadPDF()">üì• Download PDF</button>
      <button onclick="window.print()">üñ®Ô∏è Print Invoice</button>
    </div>

    <h3 style="text-align:right;">
      ‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ: <span id="grandTotal">‡ß≥0.00</span><br />
      <small>‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶Ö‡¶ô‡ßç‡¶ï ‡¶ï‡¶•‡¶æ‡ßü: <span id="inWords"></span></small>
    </h3>

    <h4>‡¶Ö‡¶ó‡ßç‡¶∞‡¶ø‡¶Æ ‡¶ú‡¶Æ‡¶æ (‡ß≥): <input type="number" id="paidAmount" value="0" min="0" onchange="calculateDue()" /></h4>
    <h4>‡¶¨‡¶æ‡¶ï‡ßÄ ‡¶ü‡¶æ‡¶ï‡¶æ: <span id="dueAmount">‡ß≥0.00</span></h4>

    <div class="signatures">
      <div>----------------------<br />‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞</div>
      <div>----------------------<br />‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞</div>
    </div>

    <div id="qrCode"></div>
  </div>

  <div class="section no-print" style="margin-top: 40px;">
    <h3>üîç Invoice Search (‡¶®‡¶æ‡¶Æ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ)</h3>
    <input type="text" id="searchInvoice" placeholder="‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ/‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." onkeyup="searchInvoice()" style="width: 100%; padding: 8px;" />
    <ul id="invoiceList" style="list-style: none; padding: 0; margin-top: 10px;"></ul>
  </div>

  <div class="no-print" style="margin-top:20px;">
    <label for="logoUpload">‡¶≤‡ßã‡¶ó‡ßã ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®: </label>
    <input type="file" id="logoUpload" accept="image/*" onchange="previewLogo(event)" />
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    // Initialization
    document.getElementById("invoiceDate").valueAsDate = new Date();
    let invoiceId = "INV" + Date.now().toString().slice(-6);
    document.getElementById("invoiceId").innerText = invoiceId;
    document.getElementById("paidAmount").value = 0;

    // Add new row
    function addRow() {
      const tbody = document.getElementById("itemsBody");
      const row = tbody.rows[0].cloneNode(true);
      row.querySelectorAll("input").forEach(input => (input.value = input.type === "number" ? (input.min || 0) : ""));
      row.querySelector(".totalCell").innerText = "0.00";
      tbody.appendChild(row);
      calculateTotal();
    }

    // Remove row
    function removeRow(btn) {
      const tbody = document.getElementById("itemsBody");
      if (tbody.rows.length > 1) {
        btn.closest("tr").remove();
        calculateTotal();
      } else {
        alert("‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
      }
    }

    // Calculate totals
    function calculateTotal() {
      let grandTotal = 0;
      const rows = document.querySelectorAll("#itemsBody tr");
      rows.forEach(row => {
        const qty = parseFloat(row.cells[1].querySelector("input").value) || 0;
        const price = parseFloat(row.cells[2].querySelector("input").value) || 0;
        const total = qty * price;
        row.cells[3].innerText = total.toFixed(2);
        grandTotal += total;
      });
      document.getElementById("grandTotal").innerText = "‡ß≥" + grandTotal.toFixed(2);
      document.getElementById("inWords").innerText = numberToWords(grandTotal);
      calculateDue();
      generateQRCode();
    }

    // Calculate due amount
    function calculateDue() {
      const grandTotal = parseFloat(document.getElementById("grandTotal").innerText.replace(/[^\d.-]/g, "")) || 0;
      const paid = parseFloat(document.getElementById("paidAmount").value) || 0;
      let due = grandTotal - paid;
      if (due < 0) due = 0;
      document.getElementById("dueAmount").innerText = "‡ß≥" + due.toFixed(2);
    }

    // Number to Bangla words (simplified)
    function numberToWords(num) {
      if (num === 0) return "‡¶∂‡ßÇ‡¶®‡ßç‡¶Ø";
      const digits = [
        "", "‡¶è‡¶ï", "‡¶¶‡ßÅ‡¶á", "‡¶§‡¶ø‡¶®", "‡¶ö‡¶æ‡¶∞", "‡¶™‡¶æ‡¶Å‡¶ö", "‡¶õ‡¶Ø‡¶º", "‡¶∏‡¶æ‡¶§", "‡¶Ü‡¶ü", "‡¶®‡¶Ø‡¶º",
      ];
      const tens = [
        "", "", "‡¶¨‡¶ø‡¶∂", "‡¶§‡ßç‡¶∞‡¶ø‡¶∂", "‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂", "‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂", "‡¶∑‡¶æ‡¶ü", "‡¶∏‡¶§‡ßç‡¶§‡¶∞", "‡¶Ü‡¶∂‡¶ø", "‡¶®‡¶¨‡ßç‡¶¨‡¶á",
      ‚Äã:contentReference[oaicite:0]{index=0}‚Äã
